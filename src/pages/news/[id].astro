---
import { getCollection, getEntry } from 'astro:content';
import BaseLayout from '../../layouts/BaseLayout.astro';
import { Card, CardHeader, CardContent } from '@/components/ui/card';
import { Badge } from '@/components/ui/badge';
import Hero from '@/components/Hero.astro';
import { render } from 'astro:content';

export async function getStaticPaths() {
  const newsItems = await getCollection('news');
  return newsItems.map((entry) => ({
    params: { id: entry.id },
    props: { entry },
  }));
}

const { entry } = Astro.props;
const { Content } = await render(entry);

// Format date in Dutch
const formattedDate = new Date(entry.data.date).toLocaleDateString('nl-NL', {
  year: 'numeric',
  month: 'long',
  day: 'numeric',
});
---

<BaseLayout title={`${entry.data.title} | Legal Design Agency`}>
  <div class="relative">
    <Hero subtitle={formattedDate} title={entry.data.title} description={entry.data.summary} />

    <div class="container mx-auto px-4 -mt-16 relative z-10">
      <Card class="bg-background border-surface-2 overflow-hidden max-w-4xl mx-auto">
        {
          entry.data.image && (
            <div class="w-full h-[400px] relative">
              <img
                src={entry.data.image.src}
                alt={entry.data.image.alt}
                class="absolute inset-0 w-full h-full object-cover"
              />
            </div>
          )
        }

        <div class="p-8 md:p-12">
          <article class="prose prose-invert max-w-none">
            <Content />
          </article>

          <div class="mt-12 pt-8 border-t border-surface-2">
            <a
              href="/news"
              class="inline-flex items-center text-text-secondary hover:text-primary transition-colors"
            >
              <svg
                xmlns="http://www.w3.org/2000/svg"
                width="20"
                height="20"
                viewBox="0 0 24 24"
                fill="none"
                stroke="currentColor"
                stroke-width="2"
                stroke-linecap="round"
                stroke-linejoin="round"
                class="mr-2"
              >
                <path d="m15 18-6-6 6-6"></path>
              </svg>
              Terug naar nieuwsoverzicht
            </a>
          </div>
        </div>
      </Card>
    </div>
  </div>
</BaseLayout>

<style>
  .prose {
    --tw-prose-headings: theme('colors.text.primary');
    --tw-prose-body: theme('colors.text.secondary');
    --tw-prose-bold: theme('colors.text.primary');
    --tw-prose-quotes: theme('colors.text.secondary');
    --tw-prose-quote-borders: theme('colors.primary.DEFAULT');
    --tw-prose-captions: theme('colors.text.tertiary');
    --tw-prose-hr: theme('colors.surface.2');
    --tw-prose-links: theme('colors.primary.DEFAULT');
    --tw-prose-counters: theme('colors.text.tertiary');
    --tw-prose-bullets: theme('colors.text.tertiary');
  }

  .prose :deep(h1),
  .prose :deep(h2),
  .prose :deep(h3),
  .prose :deep(h4) {
    scroll-margin-top: 100px;
  }

  .prose :deep(a) {
    text-decoration-line: none;
    border-bottom: 1px solid theme('colors.primary.DEFAULT');
    transition: border-color 0.2s ease;
  }

  .prose :deep(a:hover) {
    border-color: transparent;
  }
</style>
