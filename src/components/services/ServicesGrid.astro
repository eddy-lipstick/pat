---
import { Button } from '../ui/button';

import LargeCaseStudyGrid from '@/components/LargeCaseStudyGrid';
import { getCollection } from 'astro:content';

// Get all case studies and sort by date
const allCaseStudies = await getCollection('case-studies');
const sortedCaseStudies = allCaseStudies.sort((a, b) => {
  // Parse the dates and sort in descending order (newest first)
  return new Date(b.data.metadata.date).getTime() - new Date(a.data.metadata.date).getTime();
});

// Get unique services for filtering (if you still need this)
const allServices = [
  ...new Set(allCaseStudies.flatMap((study) => study.data.metadata.relatedSkills)),
].sort();

// Get unique tags for filtering (if you still need this)
const allTags = [...new Set(allCaseStudies.flatMap((study) => study.data.tags || []))].sort();
---

<section class="py-24">
  <div class="max-w-7xl mx-auto lg:px-8">
    <div class="text-center mb-16">
      <div class="inline-block">
        <span class="text-sm font-semibold text-primary tracking-wider uppercase"
          >Onze expertise</span
        >
      </div>
      <h2 class="mt-4 text-4xl font-bold text-text-primary mb-4">Bekijk onze projecten</h2>
    </div>

    <div class="container mx-auto py-12">
      <LargeCaseStudyGrid studies={sortedCaseStudies} client:load />
    </div>
  </div>
</section>
